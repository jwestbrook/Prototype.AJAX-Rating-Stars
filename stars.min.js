/**
 * http://github.com/jwestbrook/Prototype.AJAX-Rating-Stars
 */
var Stars=Class.create({_x:0,_y:0,initialize:function(a){this._initialized=!1;this.options={bindField:null,maxRating:5,container:null,imagePath:"images/",callback:null,actionURL:null,value:0,locked:!1};Object.extend(this.options,a);this.locked=this.options.locked?!0:!1;this._star_xoffsets={empty:27,full:0,half:54};this._starSrc=this.options.imagePath+"starsprite-ps.png";a=new Image;a.src=this._starSrc;this._setStarSrc=this.options.imagePath+"starsprite.png";a=new Image;a.src=this._setStarSrc;this.value=
-1;this.stars=[];this._clicked=!1;this.options.container?(this._container=$(this.options.container),this.id=this._container.id):(this.id="starsContainer."+Math.random(0,1E5),this._container=new Element("span",{id:this.id}),$(this.options.bindField).insert({after:this._container}));this._display();this.setValue(this.options.value);this._initialized=!0},_display:function(){for(var a=0;a<this.options.maxRating;a++){var b=new Element("img",{src:this.options.imagePath+"spacer.png",style:"cursor:pointer;height:30px;width:27px;",
title:"Rate as "+(a+1)});b.setStyle({backgroundImage:"url("+(this.locked?this._starSrc:this._setStarSrc)+")",backgroundPosition:this._star_xoffsets.empty+"px 0"});!this.locked&&b.observe("mouseover",this._starHover.bind(this));!this.locked&&b.observe("click",this._starClick.bind(this));!this.locked&&b.observe("mouseout",this._starClear.bind(this));this.stars.push(b);this._container.insert(b)}},_starHover:function(a){if(!this.locked){a||(a=window.event);var b=a.findElement(),c=!1;this.stars.each(function(a){a.setStyle({backgroundPosition:(c?
this._star_xoffsets.empty:this._star_xoffsets.full)+"px 0"});a==b&&(c=!0)},this)}},_starClick:function(a){if(!this.locked){a||(a=window.event);var b=a.findElement();this._clicked=!0;this.stars.each(function(a,d){if(a==b)throw this.setValue(d+1),$break;},this)}},_starClear:function(){if(!this.locked||!this._initialized){var a=!1;this.stars.each(function(b,c){c>this.value&&(a=!0);console.log("greater="+a+",value="+this.value+",index="+c);console.log(this.value+0.5==c);console.log(a?this.value+0.5==
c?this._star_xoffsets.half:this._star_xoffsets.empty:this._star_xoffsets.full);b.setStyle({backgroundPosition:(a?this.value+0.5==c?this._star_xoffsets.half:this._star_xoffsets.empty:this._star_xoffsets.full)+"px 0"});console.log(b)},this)}},setValue:function(a){var b=1<arguments.length?!!arguments[1]:!0;if(!this.locked||!this._initialized)this.value=a-1,this.options.bindField&&($(this.options.bindField).value=a),this._initialized&&b&&(this.options.actionURL?new Ajax.Request(this.options.actionURL+
a,{onComplete:this.options.callback,method:"get"}):this.options.callback&&this.options.callback(a)),this._starClear()}});